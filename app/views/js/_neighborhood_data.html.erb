<script type="text/javascript" charset="utf-8">
	function initialize() {
	
	// set up default map options
		var myLatLng = new google.maps.LatLng(37.840707, -122.251661);
		var myOptions = {
	    	zoom: 15,
		    center: myLatLng,
		    mapTypeId: google.maps.MapTypeId.ROADMAP,
			mapTypeControl: false,
			mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU},
			navigationControl: true,
			navigationControlOptions: {style: google.maps.NavigationControlStyle.SMALL}   
		};

	// build map
	   var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
	
	// set up hoods
	// declare which hoods to map
	<% [	{:name => "Rockridge", :stroke => "#FF0000", :fill => "fcb3b3"},
			{:name => "Shafter", :stroke => "#5858d4", :fill => "a9a9f7"},
			{:name => "Temescal", :stroke => "#FF0000", :fill => "fcb3b3"}	].each do |hood| %>
		
		// build points for one set of the hoods
		<% latLonArray = [] %>
		<% PolygonPoint.find_all_by_name(hood[:name]).each do |point| %>
			<% latLonArray << "new google.maps.LatLng(#{point.longitude}, #{point.latitude})" %>
		<% end %> 

		// build the polygon for one hood
		GT.hoods.<%=hood[:name]%> = new google.maps.Polygon({
		     paths: [<%= latLonArray.join(", ")%>],
		     strokeColor: "<%= hood[:stroke] %>",
		     strokeOpacity: 0.8,
		     strokeWeight: 2,
		     fillColor: "<%= hood[:fill] %>",
		     fillOpacity: 0.25
		})
		GT.hoods.<%=hood[:name]%>.setMap(map);

	<% end %>

	
	// mark nearest users in the area
		geocoder = new google.maps.Geocoder();		// user the Geocoder service to convert address to lat lon
		var image = '/images/leaf.png';			// set custom image for markers
		var mapLocation = function (street, city, state) {
		    if (geocoder) {
		      geocoder.geocode( { 'address': street+', '+city+', '+state}, function(results, status) {
		        if (status == google.maps.GeocoderStatus.OK) {
		          var marker = new google.maps.Marker({
		              map: map, 
		              position: results[0].geometry.location,
					  icon:image
		          });
		        } else {
		          alert("Geocode was not successful for the following reason: " + status);
		        }
		      });
		    }
		}
		<% User.all.collect{|x| x.address}.each do |address| %>
			mapLocation("<%= address.street_address%>", "<%= address.city%>", "<%= address.state %>");
		<% end %>

	// on mouseover, highlight neighborhoods
	// on mouseclick, show stats of neighborhood
	// 

}

	
</script>